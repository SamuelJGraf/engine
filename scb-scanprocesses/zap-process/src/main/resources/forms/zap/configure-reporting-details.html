<form role="form" name="configure-reporting">

	<script cam-script type="text/form-script">
    	camForm.on('form-loaded', function() {
      		camForm.variableManager.fetchVariable('ZAP_TARGET_NAME');
	  		camForm.variableManager.fetchVariable('ZAP_TARGET_URL');
    	});
    	camForm.on('variables-restored', function() {
      		$scope.targetName = camForm.variableManager.variableValue('ZAP_TARGET_NAME');
      		$scope.targetUrl = camForm.variableManager.variableValue('ZAP_TARGET_URL');
      		console.log("setting variables to scope");
    	});
  	</script>

	<h2>Please configure the Reporting Details for "{{ targetName }}"</h2>

	<div class="row">

		<div class="col-xs-12">
			<h3>Reporting</h3>
			
			<div class="well">Target: <a href="{{ targetUrl }}">{{ targetUrl }}</a> </div>
			
			<!-- Reporting Type configuration -->
			<div class="form-group">
				<label for="selectReportingTypes">Reporting Type Configuration</label>
				<div class="controls">
					<!--select box -->
					<select required multiple id="selectReportingTypes"
							class="form-control"
							name="reportingType"
							cam-variable-name="ZAP_REPORTING_TYPES"
							cam-variable-type="String">
						<option value="kibana" checked>Kibana Report</option>
						<option value="threadfix">Threadfix Report</option>
						<option value="json">JSON Report (NOT Implemented yet!)</option>
						<option value="csv">CSV Report (NOT Implemented yet!)</option>
						<option value="pdf">PDF Report (NOT Implemented yet!)</option>
					</select>
				</div>
			</div>

			<!-- Threadfix Configuration -->
			<div class="form-group" ng-show="reportingTypes.indexOf('threadfix')!=-1">

				<!-- API Key -->
				<div class="form-group">
					<label for="inputReportingApiKey">Reporting Api Key</label>
					<div class="controls">
						<input class="form-control"
							   id="inputReportingApiKey"
							   cam-variable-type="String"
							   cam-variable-name="ZAP_REPORTING_API_KEY"
							   type="text"
							   ng-minlength="20"
							   ng-maxlength="50"
							   name="reportingApiKey" />
					</div>
				</div>

				<!-- App ID -->
				<div class="form-group">
					<label for="inputReportingAppId">Reporting App ID</label>
					<div class="controls">
						<input class="form-control"
							   id="inputReportingAppId"
							   cam-variable-type="String"
							   cam-variable-name="ZAP_REPORTING_APP_ID"
							   type="text"
							   ng-minlength="1"
							   ng-maxlength="10"
							   name="reportingAppId" />
					</div>
				</div>

			</div>
			
			<!-- False/Positive -->
		    <div class="form-group">
			      <label for="textAreaReportingFalsePositive">False/Positive</label>
			      <div class="controls">
			        	<textarea class="form-control" id="textAreaReportingFalsePositive"
			                  cam-variable-name="ZAP_REPORTING_FALSE_POSITIVE"
			                  cam-variable-type="String"
			                  rows="5"
			                  name="reportingFalsePositive">[
	{
		"alertName" : "Web Browser XSS Protection Not Enabled",
    	"url" : "http://bodgeit:8080/bodgeit/*",
    	"param" : "",
	  	"tool":"de.iteratec.securebox.service.zap.report.FindingZap"
	},
	{
		"alertName" : "X-Content-Type-Options Header Missing",
    	"url" : "http://bodgeit:8080/bodgeit/*",
    	"param" : "",
	  	"tool":"de.iteratec.securebox.service.zap.report.FindingZap"
	},
	{
		"alertName" : "X-Frame-Options Header Not Set",
    	"url" : "http://bodgeit:8080/bodgeit/*",
    	"param" : "",
	  	"tool":"de.iteratec.securebox.service.zap.report.FindingZap"
	}
]</textarea>
			      </div>
		    </div>
		    
		    
		</div>
		
	</div>
</form>